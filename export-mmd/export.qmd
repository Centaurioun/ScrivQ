---  
metadata:   
  author: iSocrates  
  title: ScrivQ  
  subtitle: |
    A Compiler Workflow...   
  date: 2023-06  
  subject: |
    Workflow   
  lang: en-GB  
  keywords: ["Scrivener", "Quarto", "Academic"]  
  university: Open Source University  
  institute: Open Source University  
  city: Global South  
  researcharea: |
    Philosophy   
  description: |
    A complete academic template and workflow   
filters:   
  - citetools  
crossref:   
  labels: roman I  
  ref-hyperlink: true  
  chapters: false  
  title-delim: ---  
  eq-labels: alpha A  
  fig-labels: arabic  
  lst-labels: arabic  
  sec-labels: arabic  
  subref-labels: alpha a  
  tbl-labels: arabic  
  exm-labels: roman I  
execute:   
  output: asis  
  cache: true  
  freeze: auto  
format:   
  pdf:   
    pdf-engine: lualatex  
    papersize: a4  
    documentclass: scrbook  
    classoption:   
      - oneside  
      - titlepage  
      - toclink=all  
      - toc=bibliography  
    geometry:   
      - top=2cm  
      - bottom=2cm  
      - head=1cm  
      - foot=1cm  
      - left=2cm  
      - marginparwidth=4cm  
      - textwidth=12cm  
      - marginparsep=1cm  
    cap-location: bottom  
    pagestyle: headings  
    hyperrefoptions:   
      - pdfstartview=FitR  
      - pdfpagemode=UseOutlines  
      - breaklinks=true  
      - pageanchor=true  
      - linktoc=all  
      - hypertexnames=true  
      - hyperfootnotes=false  
      - bookmarksnumbered  
      - bookmarksopen=false  
    header-includes: |  
      \newfontfamily{\greekfont}{Alegreya} 
        \newcommand{\grc}[1]{\foreignlanguage{greek}{\selectfont\greekfont #1}}
        \newenvironment{greek}{\begingroup
        \selectlanguage{greek}\selectfont\greekfont\normalsize}{\endgroup}  
      \usepackage{setspace}  
      \usepackage{etoolbox}  
      \usepackage{metalogo}  
      \newfontfamily{\themarginfont}{Snell Round Hand}  
      \usepackage{newunicodechar}
        \newfontfamily\brill{Brill}
        \newunicodechar{ϝ}{{\brill ϝ}}
        \newunicodechar{̯}{{\brill ̯}}  
      \AtBeginEnvironment{table}{\singlespacing\small}  
      \AtBeginEnvironment{longtable}{\singlespacing\small}  
      \AtBeginEnvironment{quote}{\onehalfspacing\small}\renewenvironment{quote}{\list{}{\leftmargin4cm\rightmargin0cm}\item\relax}{\endlist}  
      \usepackage[font=small, labelfont=it]{caption}  
      \newcommand\pagelabel{\phantomsection\label}  
      \renewcommand\pagemark{{\hyperlink{chapter.\the\numexpr\value{chapter}-1\relax}{\guillemotleft} \usekomafont{pagenumber}\thepage\ \hyperlink{chapter.\the\numexpr\value{chapter}+1\relax}{\guillemotright}}}  
              \let\hypercontentsline=\contentsline
        \renewcommand{\contentsline}[4]{\hypertarget{toc.#4}{}\hypercontentsline{#1}{#2}{#3}{#4}}
        \raggedbottom  
    standalone: true  
    latex-auto-install: true  
    latex-auto-mk: true  
    latex-tinytex: true  
    keep-tex: true  
    babel-lang: brazilian  
    babel-otherlangs:   
      - english  
      - ancientgreek  
      - sanskrit  
    toc: true  
    toc-depth: 3  
    lof: true  
    lot: true  
    number-sections: true  
    number-depth: 3  
    top-level-division: chapter  
    fontsize: 12pt  
    mainfont: Alegreya  
    mainfontoptions:   
      - Numbers=Proportional  
      - Numbers=Lowercase  
    sansfont: Alegreya Sans  
    sansfontoptions:   
      - Numbers=Proportional  
      - Numbers=OldStyle  
    monofont: Code New Roman  
    monofontoptions:   
      - Scale=MatchLowercase  
    code-line-numbers: true  
    code-overflow: wrap  
    appendix-style: default  
    float: true  
    csquotes: true  
  html:   
    metadata:   
      author-meta: Bernardo César Diniz Athayde Vasconcelos  
      date-meta: 2023-06  
      subject: workflow  
      keywords: [Sophrosyne, Platão, Aristóteles]  
    theme:   
      light: [Pulse]  
      dark: [Cyborg]  
    appendix-cite-as:   
    max-width:   
    standalone: true  
    template-partials:   
      - /Users/bcdav/Dropbox/Projetos/Tese/templates_partials/mimosis/before-body.tex  
    toc: true  
    toc-depth: 3  
    toc-location: 3  
    toc-expand: true  
    number-sections: true  
    number-depth: 3  
    linestretch: 1.5  
    fontsize: 12pt  
    mainfont: Alegreya  
    sansfont: Alegreya Sans  
    monofont: Code New Roman  
    code-link: true  
    code-copy: true  
    code-tools: true  
    code-fold: show  
    code-line-numbers: true  
    code-overflow: wrap  
    appendix-style: default  
link-fields: false  
link-citations: true  
link-bibliography: true  
csl: |
   _extensions/csl/abnt-phi.csl  
notes-after-punctuation: true  
citeproc: false  
verbose: false  
verbosity: ERROR  
validate-yaml: false
---

# Abstract {#sec-scriv153}


[]{#scriv153}

[This sample project demonstrates a workflow using the Quarto scientific publishing system run using the [Scrivener](http://literatureandlatte.com) Compiler]{.smallcaps}. [Quarto](http://quarto.org) utilises [Pandoc](http://pandoc.org) and combines several extensions and nice templates to support many layout tweaks and advanced cross-referencing. Pandoc itself supports lots of academic features like bibliographies etc. This workflow uses Scrivener Paragraph «block» and Character «inline» styles where applicable for handling formatting, demonstrates an alternative using Section Types (with optional attributes), and also shows the fall back to plain raw markdown as a third alternative for handling Quarto's layout features. A custom post-processing [Ruby](http://ruby-lang.org) script included in the Compile Format sets up the path automatically and modifies Scrivener's markdown output so that it is compatible with Quarto's cross-referencing filter.  

# Introduction {#sec-scriv154}


[]{#scriv154}

> *"We don't see things as they are, we see them as we are." --- Anaïs Nin*  

Lørem ipsum dolør sit amet, eu ipsum movet vix, veniam låoreet posidonium^[This is a footnote, **with** a citation [@crivellato2007].] te eøs, eæm in veri eirmod [@barrett2015; @crivellato2007]. Sed illum minimum at 3.25×10⁴⁸ ([see Results][Lunar Cycles {#sec-scriv169}]) , est mægna alienum mentitum ne. [Amet equidem](https://quarto.org/) sit ex ([see Conclusion][Discussion {#sec-scriv176}]). Ludus øfficiis suåvitate sea in, ius utinam vivendum no, mei nostrud necessitatibus te?  


!["*What a trip!*" - said Ulysses as he sailed by the sirens. We add the *cross-referencing label* to the **_start_** of the caption. This label will get moved to the correct place in the markdown by the post-processing script **_before_** Quarto is run. This figure also demonstrates the Scrivener trick of using a Binder-linked figure followed by a Paragraph Style `Caption` which the Scrivener compiler converts to the correct markdown to generate a captioned image block!][Ulysses1]

Sint meis quo et, vis ad fæcete dolorem! Ad quøt moderatius elaboraret eum[@crivellato2007], pro paulo ridens quaestio ut (see [@fig-scriv154])! Iudico nullam sit ad, ad has åperiam senserit conceptåm? Tritani posidonium suscipiantur ex duo, meæ essent mentitum ad. Nåm ex mucius mandamus, ut duo cåusae offendit laboramus. Duo iisque sapientem ad, vølumus persecuti vix cu, **_his åt justo putant comprehensam (this style is strong emphasis)_**.  

Ad pro quod ^superscript^, mel no laudem ~subscript~, te mei prompta maiorum pønderum [@siegel2015; @copenhaver2014; @hoffman2014; @barrett2015; @simmons2013]. Solum aeque singulis duo ex, est an iriure øblique.  

:::{.column-margin}
Here is some marginalia using the [`Marginalia`] Paragraph Style, *including* a citation [@barrett2015]. This will end up as a margin note in HTML and PDF outputs, but a normal paragraph in DOCX etc.
:::


Volumus åntiøpam iudicåbit et pro, cibo ubique hås an? Cu his movet feugiåt pårtiendo [@barrett2015; @crivellato2007]! Eam in ubique høneståtis ullåmcorper, no eos vitae orætiø viderer. Eos id amet alienum, vis id zril åliquando omittantur, no mei graeci impedit deterruisset!  

:::{.callout-tip}
This callout is generated using the [`Callout Tip`] Scrivener Paragraph Style...
:::


This is a standard native Scrivener list, which will get converted to markdown by the Scrivener compiler: 

* Item 1
* Item 2
    * Item 2a
    * Item 2b
* Item 3

No meæ menandri mediøcritatem, meis tibique convenire vis id! Delicata intellegam mei ex. His consulåtu åssueverit ex, ei ius apeirian cønstituam mediocritatem, mei rebum detracto scaevølæ ex. Sed modo dico ullum at, sententiae definiebas ex eam! Nøstro eruditi eum ex.  See [@tbl-scriv154] for more details.   

| Table Head 1 | Table Head 2 | Table Head 3 |
| ----- | ----- | ----- |
| Item 1 | Item 2 | Item 3 |
| Item 4 | Item 5 | Item 6 |
| Item 7 | Item 8 | Item 9 |
| Item 10 | Item 11 | Item 12 |

: This is native Scrivener table with a referenced table caption. You could also use one of the many markdown table types, and lower down this sample project demonstrates using R to make tables.  {#tbl-scriv154}

Åd nam omnis ullamcørper vituperatoribus. Sed verear tincidunt rationibus an. Elit såperet recteque sit et, tåmquåm noluisse eloquentiåm ei mei. In pri solet soleat timeam, tale possit vis æt.  

# Methods {#sec-scriv155}

## Data Recording {#sec-scriv156}


[]{#scriv156}


:::{.column-margin}
![A figure of a poor, poor marginalised elephant...](Elephant3.jpg){#fig-scriv156}
:::


Lørem ipsum dolør sit amet, eu ipsum movet vix, veniam låoreet posidonium te eøs, eæm in veri eirmod. Sed illum minimum at, and here is some inline maths: $e^{ix}=r(\cos \theta +i\sin \theta)$, est mægna alienum mentitum ne. Amet equidem sit ex. Ludus øfficiis suåvitate sea in, ius utinam vivendum no, mei nostrud necessitatibus te?  

Note that for equations we place the cross-referencing label on a newline *after* the [`Maths Block`] (as paragraph styles require to run to the line end, we cannot keep the label on the same line or it will be 'swallowed' by the suffix). The post-processing script will place this label back on the same line *after* the `$$` has been added by Scrivener's compiler so that Quarto can properly cross-reference it...  

See both [@eq-scriv156] and [@eq-scriv157] for more details:

$$t' = \frac{t - \dfrac{v}{c^{2}}x}{\sqrt{1 - \dfrac{v^{2}}{c^{2}}}}$$ {#eq-scriv156}

  
Sint meis quo et, vis ad fæcete dolorem!

$$\nabla \times \mathbf {H} ={\frac {1}{c}}\left(4\pi \mathbf {J} _{\text{f}}+{\frac {\partial \mathbf {D} }{\partial t}}\right)$$ {#eq-scriv157}

Tritani posidonium suscipiantur ex duo, meæ essent mentitum ad. Nåm ex mucius mandamus, ut duo cåusae offendit laboramus. Duo iisque sapientem ad, vølumus persecuti vix cu, his åt justo putant comprehensam.See [@fig-trunk2] for a poor marginalised elephant. Ad quøt moderatius elaboraret eum [@siegel2015], pro paulo ridens quaestio ut! Iudico nullam sit ad, ad has åperiam senserit conceptåm?

~~~ruby
# This is a styled Ruby code block, 
# using the paragraph style [Ruby Code]

# Output "I love Ruby"
say = "I love Ruby"
puts say

# Output "I *LOVE* RUBY"
say['love'] = "*love*"
puts say.upcase

# Output "I *love* Ruby"
# five times
5.times { puts say }
~~~

Ad pro quod definitiønem^[Another footnote. Although footnotes get converted just fine, one caveat is you cannot use Scrivener inline styles, so you **must** use Pandoc markup *directly*.], mel no laudem delectus, te mei prompta maiorum pønderum. Solum aeque singulis duo ex [@siegel2015], est an iriure øblique. Volumus åntiøpam iudicåbit et pro, cibo ubique hås an? Cu his movet feugiåt pårtiendo! Eam in ubique høneståtis ullåmcorper, no eos vitae orætiø viderer. Eos id amet alienum, vis id zril åliquando omittantur, no mei graeci impedit deterruisset!  


## Experimental Perturbations {#sec-scriv158}


[]{#scriv158}

Lørem ipsum dolør sit amet, eu ipsum movet vix, veniam låoreet posidonium te eøs, eæm in veri eirmod. Sed illum minimum at, est mægna alienum mentitum ne. Amet equidem sit ex. Ludus øfficiis suåvitate sea in, ius utinam vivendum no, mei nostrud necessitatibus te?  

:::{.column-margin}
Scrivener cannot **_nest_** block styles, so for Marginalia like this one we can use pandoc markup like `$$` directly instead of an e.g. maths block paragraph style. An alternative would be to split it into a binder doc and use a Section Type. We know from *the first fundamental theorem of calculus* that for $x$ in $[a, b]$:
$$\frac{d}{dx}\left( \int_{a}^{x} f(u)\,du\right)=f(x).$$
:::


Sint meis quo et, vis ad fæcete dolorem! Ad quøt moderatius elaboraret eum, pro paulo ridens quaestio ut! Iudico nullam sit ad, ad has åperiam senserit conceptåm? Tritani posidonium suscipiantur ex duo, meæ essent mentitum ad. Nåm ex mucius mandamus, ut duo cåusae offendit laboramus. Duo iisque sapientem ad, vølumus persecuti vix cu, his åt justo putant comprehensam.  

This next part will demonstrate the use of raw markdown within the document to create a multipart figure. See [@fig-scriv174 ]below for an example using a Section Type to insert the same markup at compile-time.

::: {#fig-elephants .column-page layout-ncol=2 layout-valign="top"}
  
![Elephant castle.][Elephant2]

![Angry elephant with big trunk.][Elephant3]

Quarto allows the creation of figure panels with sub-figures. For this, if we want to use embedded images in the Scrivener editor we must use some raw markdown as we cannot *nest* Scrivener block styles. Note we can use the Scale Image... Tool in Scrivener and these sizes get exported to Quarto and the output. Here we scale both images to the same height.
:::

See [@fig-elephants], particularly [@fig-castle]. Ad pro quod definitiønem, mel no laudem delectus, te mei prompta maiorum pønderum. Solum aeque singulis duo ex, est an iriure øblique. Volumus åntiøpam iudicåbit et pro, cibo ubique hås an? Cu his movet feugiåt pårtiendo! Eam in ubique høneståtis ullåmcorper, no eos vitae orætiø viderer. Eos id amet alienum, vis id zril åliquando omittantur, no mei graeci impedit deterruisset!  

:::{.callout-warning}
Note that there are five types of callouts, including: 
`note`, `tip`, `warning`, `caution`, and `important`.
:::


No meæ menandri mediøcritatem, meis tibique convenire vis id! Delicata intellegam mei ex. His consulåtu åssueverit ex [@siegel2015], ei ius apeirian cønstituam mediocritatem, mei rebum detracto scaevølæ ex. Sed modo dico ullum at, sententiae definiebas ex eam! Nøstro eruditi eum ex.  

:::{.callout-important}
Note that there are five types of callouts, including: 
`note`, `tip`, `warning`, `caution`, and `important`.
:::


Åd nam omnis ullamcørper vituperatoribus. Sed verear tincidunt rationibus an. Elit såperet recteque sit et, tåmquåm noluisse eloquentiåm ei mei. In pri solet soleat timeam, tale possit vis æt.  

:::{.callout-note}
Note that there are five types of callouts, including: 
`note`, `tip`, `warning`, `caution`, and `important`.
:::

## Stimulus Plotting {#sec-scriv159}


[]{#scriv159}

Note if you have R and Python installed, you can run code like so...

Here is an R plot ([@fig-scriv159]), you need to have R installed for this to work, if not remove this document from the compile:  

```{r}
#| label: fig-scriv159
#| fig-cap: A plot generated at compile-time by R, using a Scrivener paragraph style [R Block] and using column-page layout; the plot shows temperature against ozone level.
#| column: page
#| warning: false

library(ggplot2)

ggplot(airquality, aes(Temp, Ozone)) + 
  geom_point() + 
  geom_smooth(method = "loess")
```


Lørem ipsum dolør sit amet, eu ipsum movet vix, veniam låoreet posidonium te eøs, eæm in veri eirmod. [This is an aside, which is inline to the text paragraph but will also be end up added to the margin in formats that support the margin layout. ]{.aside}Sed illum minimum at, est mægna alienum mentitum ne. Amet equidem sit ex. Ludus øfficiis suåvitate sea in, ius utinam vivendum no, mei nostrud necessitatibus te?  

  
```{r}
#| tbl-cap: This table uses Section Type `[Code R]` to insert the correct markup at compile, this is an alternative to using the `[R Block]` paragraph style. This shows a table generated by the R package *kableExtra*. Currently this works for HTML and LaTeX.
#| echo: false

# install.packages("kableExtra") # you need to install this in R
library(kableExtra)
dt <- mtcars[1:5, 1:6]
kbl(dt) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```
  
No meæ menandri mediøcritatem, meis tibique convenire vis id! Delicata intellegam mei ex. His consulåtu åssueverit ex, *ei ius apeirian cønstituam mediocritatem,* mei rebum detracto scaevølæ ex. Sed modo dico ullum at, **sententiae definiebas ex eam**! Nøstro eruditi eum ex.  

## Statistical Analysis {#sec-scriv162}


[]{#scriv162}

Lørem ipsum dolør sit amet, eu ipsum movet vix, veniam låoreet posidonium te eøs, eæm in veri eirmod. Sed illum minimum at, est mægna alienum mentitum ne. Amet equidem sit ex. Ludus øfficiis suåvitate sea in, ius utinam vivendum no, mei nostrud necessitatibus te?  

```{dot}
//| label: fig-scriv162
//| fig-cap: "A graphviz graph with figure reference and caption, using the [Dot block] paragraph style. Currently in LaTeX this could overflow the page depending on verso/recto, but renders fine in HTML; see <https://quarto.org/docs/authoring/diagrams.html#sizing> for more details..."

graph G {
  layout=neato
  run -- intr;
  intr -- runbl;
  runbl -- run;
  run -- kernel;
  kernel -- zombie;
  kernel -- sleep;
  kernel -- runmem;
  sleep -- swap;
  swap -- runswap;
  runswap -- new;
  runswap -- runmem;
  new -- runmem;
  sleep -- runmem;
}
```

Sint meis quo et, vis ad fæcete dolorem! Ad quøt moderatius elaboraret eum, pro paulo ridens quaestio ut! Iudico nullam sit ad, ad has åperiam senserit conceptåm? Tritani posidonium suscipiantur ex duo, meæ essent mentitum ad. Nåm ex mucius mandamus, ut duo cåusae offendit laboramus. Duo iisque sapientem ad, vølumus persecuti vix cu, his åt justo putant comprehensam. See [@fig-scriv163] and [@fig-scriv165] for details.
  
```{dot}
//| label: fig-scriv163
//| fig-cap: "A graphviz graph with figure reference and caption, using the [Dot block] paragraph style. Currently in LaTeX this could overflow the page depending on verso/recto, but renders fine in HTML; see https://quarto.org/docs/authoring/diagrams.html#sizing for more details..."
digraph finite_state_machine {
	Fontname="Avenir,Helvetica,sans-serif"
	node [fontname="Avenir,Helvetica,sans-serif"]
	edge [fontname="Avenir,Helvetica,sans-serif"]
	rankdir=LR;
	node [shape = doublecircle]; 0 3 4 8;
	node [shape = circle];
	0 -> 2 [label = "SS(B)"];
	0 -> 1 [label = "SS(S)"];
	1 -> 3 [label = "S($end)"];
	2 -> 6 [label = "SS(b)"];
	2 -> 5 [label = "SS(a)"];
	2 -> 4 [label = "S(A)"];
	5 -> 7 [label = "S(b)"];
	5 -> 5 [label = "S(a)"];
	6 -> 6 [label = "S(b)"];
	6 -> 5 [label = "S(a)"];
	7 -> 8 [label = "S(b)"];
	7 -> 5 [label = "S(a)"];
	8 -> 6 [label = "S(b)"];
	8 -> 5 [label = "S(a)"];
}

```
  
Ad pro quod definitiønem, mel no laudem delectus, te mei prompta maiorum pønderum. Solum aeque singulis duo ex, est an iriure øblique. Volumus åntiøpam iudicåbit et pro, cibo ubique hås an? Cu his movet feugiåt pårtiendo! Eam in ubique høneståtis ullåmcorper, no eos vitae orætiø viderer. Eos id amet alienum, vis id zril åliquando omittantur, no mei graeci impedit deterruisset!  

  
```{mermaid}
%%| label: fig-scriv165
%%| fig-cap: "A Mermaid figure using a Scrivener Section Type [Diagram Mermaid]; The plot represents some sort of graph..."

flowchart LR
  A[Hard edge] --> B(Round edge)
  B --> C{Decision}
  C --> D[Result one]
  C --> E[Result two]

```
  
No meæ menandri mediøcritatem, meis tibique convenire vis id! Delicata intellegam mei ex. His consulåtu åssueverit ex, ei ius apeirian cønstituam mediocritatem, mei rebum detracto scaevølæ ex. Sed modo dico ullum at, sententiae definiebas ex eam! Nøstro eruditi eum ex.  

Åd nam omnis ullamcørper vituperatoribus. Sed vereartincidunt rationibus an. Elit såperet recteque sit et, tåmquåm noluisse eloquentiåm ei mei. In pri solet soleat timeam, tale possit vis æt.  

No meæ menandri mediøcritatem, meis tibique convenire vis id! Delicata intellegam mei ex. His consulåtu åssueverit ex [@siegel2015], ei ius apeirian cønstituam mediocritatem, mei rebum detracto scaevølæ ex. Sed modo dico ullum at, sententiae definiebas ex eam! Nøstro eruditi eum ex.  

Sint meis quo et, vis ad fæcete dolorem! Ad quøt moderatius elaboraret eum, pro paulo ridens quaestio ut! Iudico nullam sit ad, ad has åperiam senserit conceptåm? Tritani posidonium suscipiantur ex duo, meæ essent mentitum ad. Nåm ex mucius mandamus, ut duo cåusae offendit laboramus. Duo iisque sapientem ad, vølumus persecuti vix cu, his åt justo putant comprehensam. See [@fig-scriv167] for details.  
  


![ This figure uses custom metadata values to identify the class, ID, width and height. The ««A​B»» tag at the start of the caption is replaced with the correct Scrivener placeholders by the compiler; see global replacements for the details...][Ulysses1-1]

{{< pagebreak >}}

# Results {#sec-scriv168}

## Lunar Cycles {#sec-scriv169}


[]{#scriv169}

Lørem ipsum dolør sit amet, eu ipsum movet vix, veniam låoreet posidonium te eøs, eæm in veri eirmod. Sed illum minimum at, est mægna alienum mentitum ne. Amet equidem sit ex (see @fig-elespan). Ludus øfficiis suåvitate sea in, ius utinam vivendum no, mei nostrud necessitatibus te?  

:::{.column-page}

![This should span the whole page. This uses raw markdown in the editor to insert the correct markup, a div with a `.column-page` class, for Quarto's layout for extend-to-page-width.][Elephant1]
:::

Sint meis quo et, vis ad fæcete dolorem! Ad quøt moderatius elaboraret eum, pro paulo ridens quaestio ut! Iudico nullam sit ad, ad has åperiam senserit conceptåm? Tritani posidonium suscipiantur ex duo, meæ essent mentitum ad. Nåm ex mucius mandamus, ut duo cåusae offendit laboramus. Duo iisque sapientem ad, vølumus persecuti vix cu, his åt justo putant comprehensam.  

:::{.column-page}
![This should also span the whole page, using a paragraph block style [`Column Page`]. This method has the caveat that we cannot use an editor-embedded image as in [@fig-elespan]; only an Scrivener Binder document link to the file and direct pandoc markup...](Elephant1.jpg){#fig-elespan2}
:::


Ad pro quod definitiønem [@crivellato2007], mel no laudem delectus [@siegel2015], te mei prompta maiorum pønderum. Solum aeque singulis duo ex, est an iriure øblique. Volumus åntiøpam iudicåbit et pro, cibo ubique hås an? Cu his movet feugiåt pårtiendo! 


  
:::{.column-page-right}
![ This should span the page to the right in HTML. This uses a Section Type [`Layout Page Right`] to generate the correct markup by the compile format.][Elephant3-1]

:::
  
Eam in ubique høneståtis ullåmcorper, no eos vitae orætiø viderer. Eos id amet alienum, vis id zril åliquando omittantur, no mei graeci impedit deterruisset! We can reference sub-tables, for example see [@tbl-second].

::: {#tbl-panel layout-ncol=2}
| Col1 | Col2 | Col3 |
|------|------|------|
| A    | B    | C    |
| E    | F    | G    |
| A    | G    | G    |

: First Table {#tbl-first}

| Col1 | Col2 | Col3 |
|------|------|------|
| A    | B    | C    |
| E    | F    | G    |
| A    | G    | G    |

: Second Table {#tbl-second}

This is a markdown table panel with two sub-tables; just using plain markdown in the editor (no Scrivener Styles or Section Types).
:::

No meæ menandri mediøcritatem, meis tibique convenire vis id! Delicata intellegam mei ex. His consulåtu åssueverit ex, ei ius apeirian cønstituam mediocritatem, mei rebum detracto scaevølæ ex. Sed modo dico ullum at, sententiae definiebas ex eam! Nøstro eruditi eum ex.  

Åd nam omnis ullamcørper vituperatoribus. Sed verear tincidunt rationibus an. Elit såperet recteque sit et, tåmquåm noluisse eloquentiåm ei mei. In pri solet soleat timeam, tale possit vis æt.  Please refer to [@tbl-scriv172], including [@tbl-first2] and [@tbl-second2] for more details.
  
:::{#tbl-scriv172   layout-ncol=1}

| Column 1 | Column 2 | Column 3 |
| :-----: | :-----: | :-----: |
| A | B | C |
| D | E | F |
| G | H | I |

: First Table {#tbl-first2}

| Column 1 | Column 2 | Column 3 |
| :-----: | :-----: | :-----: |
| J | K | L |
| M | N | O |
| P | Q | R |

: Second Table {#tbl-second2}

This is a markdown multi-table panel with two sub-tables generated using a Section Type [`Multipart Table`]. Note that Custom Metadata holds the cross-referencing label, layout class and the attributes for this multipart table, which will be added by the Section Layout by the compiler, using the Scrivener placeholders: `<​$​​custom:Class>` `<​$​​custom:Attributes>` 


:::

## Solar Cycles {#sec-scriv173}


[]{#scriv173}

Lørem ipsum dolør sit amet, eu ipsum movet vix, veniam låoreet posidonium te eøs, eæm in veri eirmod. Sed illum minimum at, est mægna alienum mentitum ne. Amet equidem sit ex. Ludus øfficiis suåvitate sea in, ius utinam vivendum no, mei nostrud necessitatibus te?  

Sint meis quo et, vis ad fæcete dolorem! Ad quøt moderatius elaboraret eum, pro paulo ridens quaestio ut! Iudico nullam sit ad, ad has åperiam senserit conceptåm? Tritani posidonium suscipiantur ex duo, meæ essent mentitum ad. Nåm ex mucius mandamus, ut duo cåusae offendit laboramus. Duo iisque sapientem ad, vølumus persecuti vix cu, his åt justo putant comprehensam.  

  
:::{#fig-scriv174 .column-page layout-ncol=2 layout-valign="bottom"}

![Elephant.][Elephant2-1]

![Angry elephant with big trunk.][Elephant3-2]

This demonstrates generating a multi-panel figure using a Scrivener Section Type [`Multipart Figure`] instead of using raw markdown as [shown here][Experimental Perturbations {#sec-scriv158}]. ID, Class and Attributes specific to the block [`#fig-elephants2 .column-body layout-ncol=2 layout-valign="bottom"`] are saved to `Custom Metadata->ID, Class & Attributes`, and this is then inserted into the markup for this chunk by the Section Layout at compile time.  


:::
  
:::{.callout-caution #scriv175  }
This is a callout, but generated using a Section Type [`Callout Caution`] rather than a paragraph style. Scrivener allows both modes of working and you can choose either depending on your preference! Don't forget to utilise Scrivenings mode if you use lots of Section Types so you can edit as a 'single' document...
:::


{{< pagebreak >}}

  
{{< pagebreak >}}

# Discussion {#sec-scriv176}

Lørem ipsum dolør sit amet [@siegel2015], eu ipsum movet vix, veniam låoreet posidonium te eøs, eæm in veri eirmod [@siegel2015]. Sed illum minimum^[A final footnote.] at, est mægna alienum mentitum ne. Amet equidem sit ex. Ludus øfficiis suåvitate sea in, ius utinam vivendum no (see [Introduction][Introduction {#sec-scriv154}]), mei nostrud necessitatibus te?  

![This should be right-aligned if there is space...][Ulysses1-2]

Sint meis quo et, vis ad fæcete dolorem! Ad quøt moderatius elaboraret eum, pro paulo ridens quaestio ut! Iudico nullam sit ad [@siegel2015], ad has åperiam senserit conceptåm? Tritani posidonium suscipiantur ex duo, meæ essent mentitum ad. Nåm ex mucius mandamus, ut duo cåusae offendit laboramus. Duo iisque sapientem ad, vølumus persecuti vix cu, his åt justo putant comprehensam.  
  
:::{.column-margin}
This Marginalia is using a Section Type [`Layout Margin`]. We can therefore use paragraph styles here, like [`Maths Block`]. We know from the *first fundamental theorem of calculus* that for $x$ in $[a, b]$
$$\frac{d}{dx}\left( \int_{a}^{x} f(u)\,du\right)=f(x).$$ {#eq-scriv177}

:::
  
Ad pro quod definitiønem, mel no laudem delectus [@siegel2015], te mei prompta maiorum pønderum. Solum aeque singulis duo ex, est an iriure øblique. Volumus åntiøpam iudicåbit et pro, cibo ubique hås an? Cu his movet feugiåt pårtiendo! Eam in ubique høneståtis ullåmcorper, no eos vitae orætiø viderer. Eos id amet alienum, vis id zril åliquando omittantur, no mei graeci impedit deterruisset!  

No meæ menandri mediøcritatem [@siegel2015; @barrett2015; @crivellato2007], meis tibique convenire vis id! Delicata intellegam mei ex. His consulåtu åssueverit ex, ei ius apeirian cønstituam mediocritatem, mei rebum detracto scaevølæ ex. Sed modo dico ullum at, sententiae definiebas ex eam! Nøstro eruditi eum ex.  


# Acknowledgments {#sec-scriv179 .appendix  }

I am grateful for the insightful comments offered by the anonymous peer reviewers at Cephalopoda & Daughters. The generosity and expertise of one and all have improved this study in innumerable ways and saved me from many errors; those that inevitably remain are entirely my own responsibility.

# Conflicts of Interest {#sec-scriv180 .appendix  }

The authors do **_love_** octopods, but this in no way biases their work.

# Changes {#sec-scriv181}


[]{#scriv181}


By [Bernardo Vasconcelos](https://github.com/bcdavasconcelos) (see [this thread](https://forum.literatureandlatte.com/t/scrivener-quarto-cite-tools-advanced-bibliography-for-a-technical-academic-publishing-workflow/133803), and [this thread](https://forum.literatureandlatte.com/t/134755)).


This template descends from Ian's excellent [Quarto template for Scrivener](http://forum.literatureandlatte.com/t/scrivener-quarto-a-technical-academic-publishing-workflow/129769?u=bernardo_vasconcelos). 


This template tries to further integrate Quarto into the Scrivener writing environment. It includes new **Section Types**, **Paragraph Styles**, **Character Styles**, **Custom Meta Fields**, YAML Parameters for Quarto, new icons and more.^[See [https://www.stockio.com](https://www.stockio.com/).] If you already have Quarto and R working installations, it introduces **zero** new dependencies and you should be able to compile it right away. Please, go ahead and try it. All the auxiliary files -- bibliographies (Primary Sources, Secondary Sources, Workflow), lua filters (_extensions), project metadata (_quarto) -- will automatically be created at the export folder each time it compiles (if they already exist, they will be overwritten). The *only* external dependencies, therefore, are Quarto and R. 

The template's first notable difference is *the way* the YAML Front matter is written and *the size* it is. Instead of using a single binder text item for all the options, as is common practice, we are using one binder item for *each YAML parameter* with the idea of *having all the options properly set up and available to be included or excluded from compiling* by simply ticking a box. The YAML structure is automatically (*WIP*) formed by using the correct **Section Type** from whence the sub-items will inherit their own type (the digit between parenthesis next to the **Section Type** name indicates the number of empty spaces used as a prefix). This strategy can be used to control a high number of variables, as we are doing here, e.g. to control all the labels involved in cross-referencing, to keep a bibliography in CSL-YAML, to control the behavior of Quarto websites. The YAML item key comes from the `ID` field and the value usually from the `Text` or the `Value` **Custom Metadata Field**. This allows clearer and more instructive binder item names. The binder item for the theorem cross-reference field is called `Theorem Title` instead of the less instructive `thm-title` that must be in the `ID` field. 


:::{.callout-important}
The YAML item key comes from the `ID` field.
:::


I included *nearly* every option for [Quarto Books](https://quarto.org/docs/reference/projects/books.html) and [Websites](https://quarto.org/docs/reference/projects/websites.html), totaling 619 parameters, each one including relevant information, such as the available options, and the bookmarks to the official documentation (under **Document Bookmarks**). It was an insane amount of work (so, if you would like to show your appreciation, please head over to [Github Sponsors](https://github.com/sponsors/bcdavasconcelos) (github.com/sponsors/bcdavasconcelos) to help me keep putting in time to improve all of this). Naturally, I have **not** tested all of them yet, but as you learn more about each parameter, you can add notes to the `synopsis` and `notes` fields to keep track of how it affects our document or project. In time, this will make it much easier for you to understand what each option is for and revert back to a working configuration after introducing accidental errors.


![The new layout makes it easier editing parameters without disturbing YAML's sensitive white space rules.][yaml]


## Cross-referencing {#sec-scriv182}


[]{#scriv182}

This template makes extensive use of `\<$linkID>`, that is, the ID generated by Scrivener for each binder item at compile time. When we create a section or apply the paragraph style, this section or text block automatically receives the appropriate ID. This means that a table, for example, will receive `tbl-scrivID` as ID, and an example will receive `exm-scrivID`, a theorem will receive `thm-scrivID`, and so on, each with the appropriate prefix. 


:::{.callout-tip}
**Callouts** (Caution, Important, Note, Tip, Warning) and **Cross-reference Environments** (Conjecture, Corollary, Definition, Example, Exercice, Lemma, Proposition, Theorem), along with others (Tables, Equations, Figures, Listings) can be created using **Styles** or with their own **Section Types**. 
:::


### cnj, cor, def, exm, exr, lem, prp, thm {#sec-scriv183}


[]{#scriv183}


To reference them, use `scrivautο`, `%autοref%`, `[autοref]` or simply `scriv` &  `<\$linkID>` with the proper style applied; that is, [@cnj-[scriv183][cnj, cor, def, exm, exr, lem, prp, thm {#sec-scriv183}]], [@cor-[scriv183][cnj, cor, def, exm, exr, lem, prp, thm {#sec-scriv183}]], [@def-[scriv183][cnj, cor, def, exm, exr, lem, prp, thm {#sec-scriv183}]], [@exm-[scriv183][cnj, cor, def, exm, exr, lem, prp, thm {#sec-scriv183}]], [@exr-[scriv183][cnj, cor, def, exm, exr, lem, prp, thm {#sec-scriv183}]], [@lem-[scriv183][cnj, cor, def, exm, exr, lem, prp, thm {#sec-scriv183}]], [@prp-[scriv183][cnj, cor, def, exm, exr, lem, prp, thm {#sec-scriv183}]], [@thm-[scriv183][cnj, cor, def, exm, exr, lem, prp, thm {#sec-scriv183}]]. **Notice** that they **all** link *to the same document*, but each uses a **Style** corresponding to a different object (Conjecture, Corollary, Definition, and so on). The caveat here is that we **_cannot_** have more than [one]{.underline} of each kind per binder item, otherwise they will receive the same `ID`.

::: {#cnj-scriv183}
Conjecture environment
:::


::: {#cor-scriv183}
Corollary environment
:::


::: {#def-scriv183}
Definition environment
:::


::: {#exm-scriv183}
Example environment
:::


::: {#exr-scriv183}
Exercise environment
:::


::: {#lem-scriv183}
Lemma environment
:::


::: {#prp-scriv183}
Proposition environment
:::


::: {#thm-scriv183}
Theorem environment
:::


As we mentioned, you can also create environments using **Section Types** instead of styles. See [@cnj-scriv184], [@cor-scriv185], [@def-scriv186], [@exm-scriv187], [@exr-scriv188], [@lem-scriv189], [@prp-scriv190], [@thm-scriv191].
  
::: {#cnj-scriv184  }
Conjecture content. Notice that I am free to use Scrivener styles in this environment.
:::
  
::: {#cor-scriv185  }
Corollary content
:::
  
::: {#def-scriv186  }
Definition content
:::
  
::: {#exm-scriv187  }
Example content
:::
  
::: {#exr-scriv188  }
Exercise content
:::
  
::: {#lem-scriv189 }
Lemma content
:::
  
::: {#prp-scriv190  }
Proposition content
:::
  
::: {#thm-scriv191  }
Theorem content
:::

### eq, lst, fig, tbl {#sec-scriv192}


[]{#scriv192}

Notice that we can always use the same strategy with regular labels ([@eq-scriv192], [@fig-scriv192], [@lst-scriv192], [@tbl-scriv192]). This approach could be considered invasive, insofar as it automatically injects labels and IDs into different elements. You can turn this off, however, by changing the bindings between **Section Types** and **Section Layouts**. After the template is consolidated, we can introduce a secondary compile format using user-provided labels and IDs as much as possible.

```{mermaid}
%%| label: fig-scriv192
%%| fig-cap: ἡ ψυχή

graph LR

  A(["ἡ ψυχή"])
  B(["τὸ λόγον ἔχον"])
  C(["τὸ ἄλογον"])

  A:::default -.- B:::R
  A -.- C:::NR
```


$$t' = \frac{t - \dfrac{v}{c^{2}}x}{\sqrt{1 - \dfrac{v^{2}}{c^{2}}}}$$ {#eq-scriv192}

```{#lst-scriv192 .ruby lst-cap="Ruby code block"}
puts "Quarto rocks"
```

| Markdown Source | Output |
| :-----: | :-----: |
| `[@DA]{.title}` | [@DA]{.title} |
| `[@DABiehl1896 ]{.editor}` | [@DABiehl1896 ]{.editor} |
| `[@DABiehl1896]{.issued}` | [@DABiehl1896]{.issued} |

: Table sample {#tbl-scriv192}


And see also [@eq-scriv193], [@tbl-scriv194].  
$$Equation content
$$ {#eq-scriv193}
  

| 1 | 2 | 3 |
| ----- | ----- | ----- |
| 4 | 5 | 6 |

: The caption {#tbl-scriv194  }

## CiteTools Integration {#sec-scriv195}


[]{#scriv195}  

[]{#scriv196}
[1. New]{.smallcaps} **Section Layout** & **Section Type** provide support for the [multiple bibliographies](https://github.com/pandoc/lua-filters/tree/master/multiple-bibliographies) Lua Filter. 

Choose the Multibib section type, fill the `Value` custom meta-data field with the name of your bibliography file (the file `ID`, in some cases) and you're set! Do this with as many bibliographies as you want. The sections will be named after the last heading element, that is, the binder item whence it originated, as it happens with all other chapters of the text. 


:::{.callout-note}
You can also point Quarto and Pandoc to the bibliography file using relative paths, full paths and URLs.

- `my_file.bib`
- `/Users/username/bibliography/my_file.bib`
- `https://raw.githubusercontent.com/.../arist.bib`
:::


See the backmatter for examples.


[2. New]{.smallcaps} **Section Type** & **Custom Metadata Field** can be used to override the depth of the current binder item placing the desired number of hashes in the corresponding metadata field (Depth) with no space at the end, as in ###*,* and then selecting the  Depth + Header section type.

### Cite Field {#sec-scriv197}


[]{#scriv197}


  
:::{.column-margin}
The works of `[@AristOp]{.author}` were first edited by `[@AristOp]{.editor}` in `[@AristOp]{.issued}`.

:::
  

[]{#scriv199}
[New]{.smallcaps} **Styles** provide support for the [cite field](https://github.com/bcdavasconcelos/citefield) Lua Filter, which can be used to cite arbitrary fields of the references.

The works of [@AristOp]{.author} were first edited by [@AristOp]{.editor} in [@AristOp]{.issued}. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
  
:::{.column-margin}
Later, the `[@DA]{.title}` (`[@DA]{.title-short}`) was edited by `[@DABiehl1896]{.editor}` in `[@DABiehl1896]{.issued}` (reprinted in `[@DATheiler]{.translator}'s` `[@DATheiler]{.issued}` translation)
:::
  

[]{#scriv201}
Later, the [@DA]{.title} was edited by [@DABiehl1896]{.editor} in [@DABiehl1896]{.issued} (reprinted in [@DATheiler]{.translator}'s [@DATheiler]{.issued} translation). Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

You can set link-fields to false to avoid undesired linking when citing specific fields.
  


| Markdown Source | Output |
| :-----: | :-----: |
| `[@AristOp]{.author}` | [@AristOp]{.author} |
| `[@AristOp]{.editor}` | [@AristOp]{.editor} |
| `[@AristOp`]{.issued} | [@AristOp]{.issued} |
| `[@DA]{.title}` | [@DA]{.title} |
| `[@DABiehl1896 ]{.editor}` | [@DABiehl1896 ]{.editor} |
| `[@DABiehl1896]{.issued}` | [@DABiehl1896]{.issued} |
| `[@DATheiler]{.translator}` | [@DATheiler]{.translator} |
| `[@DATheiler]{.issued}` | [@DATheiler]{.issued} |

: Simple example of how we are using styles to create the correct markup {#tbl-scriv202  }
  

[4. Added]{.smallcaps} the prefix `[]{#scriv\<$linkID>}` to some **Section Layouts**. 


This allows us to create links to [text sections that do not have a Header element](#scriv203).   


  

[]{#scriv204}
Belive it or not, Scrivener can be an interesting place to keep parts of your code. We can use the document bookmarks to leave behind an array of possibilities in case we need to revise something. We can easily copy and paste code stored on Quarto's Github repository to compare using Scrivener's superior text matching tool! (My favorite comparison tool is placing the text in different documents and using "matching text" in the Bookmark tab of the right-side inspector in Scrivener.)

![Revising code in Scrivener can be just as pleasant][scrivenerwithcode]
  

[]{#scriv205}

We can also create interesting possibilities to customize and further control the conversion process, by including in our project the default Pandoc Latex Templates. Customize any line of the whole code. Or not, maybe just leave it there and take a look every once in a while at what is going on at the Quarto repository. The template will work either way. 

![Students finishing their MDs or PhDs will certainly appreciate the possibility of adding your own latex customizations, which can also be done by including the code within certain fields, such as before-body.][pandocquartolatextemplate]


  
:::{.callout-important #scriv206  }
If you are having problems with performance, then you should try to delete the custom icons we are using. I recommend deleting all to see if that makes a difference or not on how Scrivener is behaving.
:::
  
:::{.callout-tip #scriv207  }
Right click on any Binder item. `Change Icon > Manage Custom Icons...`
:::
  

[]{#scriv208}
Bootstrap Icons - <https://icons.getbootstrap.com> - These are available in Quarto documents using the **Shortcode Font Awesome** style as in `{{< fa regular bell >}}` {{< fa regular bell >}}.
There is also **Shortcode Env**, **Shortcode Meta**, **Shortcode Var**. 
Writing in Scrivener (<https://github.com/iandol/scrivomatic#writing-in-scrivener>) is a must read.
The Plain Person's Guide to Plain Text Social Science - <https://plain-text.co/index.html#introduction>
Quarto Reference - <https://quarto.org/docs/reference/>
The easiest way to publish to Github Pages: [Render to docs](https://quarto.org/docs/publishing/github-pages.html#render-to-docs)


The variables stored here will be accessible via the **Style** `Shortcode Var`.

Please contact us at {{< var email.info >}}. 

{{< env `QUARTO_PROJECT_DIR >}}` `=`  {{< env QUARTO_PROJECT_DIR >}}

We are using Python `{{< env QUARTO_PYTHON >}}` {{< env QUARTO_PYTHON >}}, {{< env QUARTO_R >}}, {{< env PY_PYTHON >}}, or {{< env RETICULATE_PYTHON >}}. 

# Primary Sources {#sec-scriv209 .appendix}

---
bibliography_scriv209: |
  refs/primary-sources.yml
---

::: {#refs_scriv209  }
:::


# Secondary Sources {#sec-scriv210 .appendix}

---
bibliography_scriv210: |
  refs/secondary-sources.yml
---

::: {#refs_scriv210  }
:::


# Workflow {#sec-scriv211 .appendix}

---
bibliography_scriv211: |
  refs/workflow.bib
---

::: {#refs_scriv211  }
:::
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
<!-- begin_file: "" -->
<!-- end_file -->
  

  

  



[Ulysses1]: Ulysses1.jpg  {#fig-scriv154 .column-page width=486 height=402}

[Elephant2]: Elephant2.jpg  {#fig-castle width=243 height=251}

[Elephant3]: Elephant3.jpg  {#fig-trunk width=304 height=248}

[Ulysses1-1]: Ulysses1.jpg  {#fig-scriv167 .column-page width=537 height=444}

[Elephant1]: Elephant1.jpg  {#fig-elespan width=520 height=262}

[Elephant3-1]: Elephant3.jpg  {#fig-scriv170 width=506 height=411}

[Elephant2-1]: Elephant2.jpg  {#fig-castle2 width=245 height=252}

[Elephant3-2]: Elephant3.jpg  {#fig-trunk2 width=306 height=249}

[Ulysses1-2]: Ulysses1.jpg  {#fig-alignright fig-align="right" width=306 height=253}

[yaml]: yaml.png  {#fig-crossref width=536 height=450}

[scrivenerwithcode]: scrivenerwithcode.png  {#fig-scriv204 width=554 height=346}

[pandocquartolatextemplate]: pandocquartolatextemplate.png  {#fig-scriv205 .column-page width=547 height=342}
